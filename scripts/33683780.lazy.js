!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.Blazy=b()}(this,function(){function a(a){if(!document.querySelectorAll){var d=document.createStyleSheet();document.querySelectorAll=function(a,b,c,e,f){for(f=document.all,b=[],a=a.replace(/\[for\b/gi,"[htmlFor").split(","),c=a.length;c--;){for(d.addRule(a[c],"k:v"),e=f.length;e--;)f[e].currentStyle.k&&b.push(f[e]);d.removeRule(0)}return b}}q=!0,n=[],m={},l=a||{},l.error=l.error||!1,l.offset=l.offset||100,l.success=l.success||!1,l.selector=l.selector||".b-lazy",l.separator=l.separator||"|",l.container=l.container?document.querySelectorAll(l.container):!1,l.errorClass=l.errorClass||"b-error",l.breakpoints=l.breakpoints||!1,l.successClass=l.successClass||"b-loaded",l.src=k=l.src||"data-src",p=1<window.devicePixelRatio,m.top=0-l.offset,m.left=0-l.offset,r=j(c,25),s=j(f,50),f(),i(l.breakpoints,function(a){return a.width>=window.screen.width?(k=a.src,!1):void 0}),b()}function b(){e(l.selector),q&&(q=!1,l.container&&i(l.container,function(a){g(a,"scroll",r)}),g(window,"resize",s),g(window,"resize",r),g(window,"scroll",r)),c()}function c(){for(var b=0;o>b;b++){var c=n[b],d=c.getBoundingClientRect();(d.right>=m.left&&d.bottom>=m.top&&d.left<=m.right&&d.top<=m.bottom||-1!==(" "+c.className+" ").indexOf(" "+l.successClass+" "))&&(a.prototype.load(c),n.splice(b,1),o--,b--)}0===o&&a.prototype.destroy()}function d(a,b){if(b||0<a.offsetWidth&&0<a.offsetHeight){var c=a.getAttribute(k)||a.getAttribute(l.src);if(c){var c=c.split(l.separator),d=c[p&&1<c.length?1:0],c=new Image;i(l.breakpoints,function(b){a.removeAttribute(b.src)}),a.removeAttribute(l.src),c.onerror=function(){l.error&&l.error(a,"invalid"),a.className=a.className+" "+l.errorClass},c.onload=function(){"img"===a.nodeName.toLowerCase()?a.src=d:a.style.backgroundImage='url("'+d+'")',a.className=a.className+" "+l.successClass,l.success&&l.success(a)},c.src=d}else l.error&&l.error(a,"missing"),a.className=a.className+" "+l.errorClass}}function e(a){a=document.querySelectorAll(a);for(var b=o=a.length;b--;n.unshift(a[b]));}function f(){m.bottom=(window.innerHeight||document.documentElement.clientHeight)+l.offset,m.right=(window.innerWidth||document.documentElement.clientWidth)+l.offset}function g(a,b,c){a.attachEvent?a.attachEvent&&a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)}function h(a,b,c){a.detachEvent?a.detachEvent&&a.detachEvent("on"+b,c):a.removeEventListener(b,c,!1)}function i(a,b){if(a&&b)for(var c=a.length,d=0;c>d&&!1!==b(a[d],d);d++);}function j(a,b){var c=0;return function(){var d=+new Date;b>d-c||(c=d,a.apply(n,arguments))}}var k,l,m,n,o,p,q,r,s;return a.prototype.revalidate=function(){b()},a.prototype.load=function(a,b){-1===(" "+a.className+" ").indexOf(" "+l.successClass+" ")&&d(a,b)},a.prototype.destroy=function(){l.container&&i(l.container,function(a){h(a,"scroll",r)}),h(window,"scroll",r),h(window,"resize",r),h(window,"resize",s),o=0,n.length=0,q=!0},a}),new Blazy({offset:100});